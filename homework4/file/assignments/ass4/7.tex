\section{Question 7}

\begin{question}
  For each value of average ratings (score), how many stations have that
  rating? Sort the result by descending rating.
\end{question}

\begin{answer}

  \begin{lstlisting}[language=js]
db.stations.aggregate([{
    $group: {
        _id: "$extra.score", stations: {"$sum": 1}
    }
}, {$project: {_id: 0, score: "$_id", stations: 1}}, {$sort: {score: -1}}])
  \end{lstlisting}
  Result
  \begin{lstlisting}[language=js]
[
  { stations: 1, score: 4.7 }, { stations: 2, score: 4.5 },
  { stations: 2, score: 4.4 }, { stations: 2, score: 4.3 },
  { stations: 7, score: 4.2 }, { stations: 5, score: 4.1 },
  { stations: 9, score: 4 }, { stations: 9, score: 3.9 },
  { stations: 1, score: 3.8 }, { stations: 2, score: 3.7 },
  { stations: 1, score: 3.6 }, { stations: 4, score: 3.5 },
  { stations: 3, score: 3.4 }, { stations: 1, score: 3.2 },
  { stations: 4, score: 3 }, { stations: 2, score: 2.8 },
  { stations: 1, score: 2.7 }, { stations: 1, score: 2.5 },
  { stations: 1, score: 2.4 }, { stations: 1, score: 2.1 }
]
  \end{lstlisting}

\end{answer}
\pagebreak
